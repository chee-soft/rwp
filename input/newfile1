{{toc}}

h1. Модули

h2. Заказы

h3. Поля модуля:

*Панель Статус*

* Статус (выпадающий список):
** Обращение (частник);
** Обращение (агент);
** Интерес;
** Опцион;
** Предоплата;
** Оплачено;
** В круизе;
** Выполнен;
** Отказ;
** Аннуляция
* Дата истечения опциона (дата) – поле активно, только если статус - «Опцион».
* Причина отказа (текстовое поле) – поле активно, только если статус - «Отказ»
* Причина аннуляции (текстовое поле) – поле активно, только если статус «Аннуляция»
* Дата последнего изменения статуса (вычисляемое поле, при изменении статуса выставляется как текущая дата) *назначение поля непонятно, зачем оно нужно, если поле Статус - журналируемое?*
* Дата получения предоплаты (вычисляемое поле, выставляется текущая дата при выставлении статуса «Предоплата»)
* Дата договора (дата)

*Панель «Основные данные»*

* Номер заказа (автоинкремент)
* Спец. предложения (вычисляемое поле, не редактируется, многострочное текстовое поле, заполняется в формате: «Название. Описание. Действует с/по, Опубликовано на сайте»; данные берутся из модуля Спец. предложения).
* Количество участников (текстовое поле; будет использовано при расчете комиссий при добавлении Участников круиза) *[поле Количество участников, возможно, следует заполнять автоматически (вычислять количество привязанных участников), но оставить редактируемым. Непонятно, как оно участвует в расчете комиссий.]*
* Документы получены (выпадающий список: нет, отправлены, получены)
* Комиссия на круиз (текстовое поле, заполняется автоматически согласно количеству участников). Рядом кнопка «Пересчитать комиссию», при нажатии обновляется комиссия во всех участниках круиза.
* Заказчик (выбор из клиентов) – поле неактивно, если статус «Обращение (агент)» или если заполнено поле Агент.
* Агент (выбор из агентов) – поле неактивно, если статус «Обращение (частник)» или если заполнено поле Заказчик. Поля Закачик и Агент могут быть объединены в одно поле «Заказчик» с типом «Parent»
* Ответственный (выбор из пользователей)
* Менеджер по продажам (выбор из пользователей)
* Документ (файл)

*Панель «Продукт»*

* Название круиза (выбор из продуктов)
* Оператор (вычисляемое поле, вычисляется по продукту, не редактируется)
* Выставлять счет нам (дата)(вычисляемое поле, = текущая дата - количество дней, указанных в Оператор, поле "Выставлять счет нам до начала круиза за (дней)".)
* Выставлять счет клиенту (дата) (вычисляемое поле:«Выставлять счет нам» +3 дня)
* Регион (вычисляемое поле, вычисляется по продукту, не редактируется)
* Маршрут (вычисляемое поле, вычисляется по продукту, не редактируется)
* Название круиза (вычисляемое поле, вычисляется по продукту, не редактируется)
* Дата начала круиза (вычисляемое поле, вычисляется по продукту, не редактируется)
* Дата окончания круиза (вычисляемое поле, вычисляется по продукту, не редактируется)
* Дата завершения круиза и экскурсий (вычисляемое поле: наиболее поздняя дата из ((даты начала круиза + количество дней) и (самая поздняя Дата окончания из всех связанных экскурсий)))
-* Питание (вычисляемое поле, вычисляется по Заказанной гостинице, не редактируется)- *поле не нужно, уточняла у клиента*
* Примечания (текстовое многострочное)

*Итого для клиента за все услуги*

* Курс (дата курса) - (дата)
* Полная цена (сумма в USD) - (вычисляемое поле, не редактируемое)
Вычисляется так: суммируются с учетом валюты значения из поля «Полная стоимость для клиента» в разделе «Стоимость услуги» на связанных с заказом записях об Участниках круиза, Услугах на судне, Авиаперелетах, Заказанных гостиницах, Заказанных экскурсиях, Трансферах, Визах, Страховках. Значение курса берется из модуля «Курсы валют» для указанной даты (Заказ: поле Курс) и валюты (поле Валюта на блоке стоимость).
* Скидка в USD (вычисляемое поле, не редактируемое)
Вычисляется так: суммируются ВИДИМЫЕ скидки из блока «Стоимость для клиента» в разделе «Стоимость услуги» на связанных с заказом записях о Участниках круиза, Услугах на судне, Авиаперелетах, Заказанных гостиницах, Заказанных экскурсиях, Трансферах, Визах, Страховках. Суммируются с учетом курса валюты.Значение курса берется из модуля «Курсы валют» для указанной даты (Заказ: поле Курс) и валюты (поле Валюта на блоке стоимость).
* Нетто в USD (вычисляемое поле, не редактируемое)
Вычисляется так: суммируются с учетом валюты значения из поля «Нетто» в разделе «Стоимость услуги» на связанных с заказом записях об Участниках круиза, Услугах на судне, Авиаперелетах, Заказанных гостиницах, Заказанных экскурсиях, Трансферах, Визах, Страховках. Значение курса берется из модуля «Курсы валют» для указанной даты (Заказ: поле Курс) и валюты (поле Валюта на блоке стоимость).
* Брутто в USD (вычисляемое поле, не редактируемое)
Вычисляется так: суммируются с учетом валюты значения из поля «Брутто» в разделе «Стоимость услуги» на связанных с заказом записях об Участниках круиза, Услугах на судне, Авиаперелетах, Заказанных гостиницах, Заказанных экскурсиях, Трансферах, Визах, Страховках. Значение курса берется из модуля «Курсы валют» для указанной даты (Заказ: поле Курс) и валюты (поле Валюта на блоке стоимость).

*Доход*

* Доход в USD (вычисляемое поле, не редактируется): Брутто-Нетто
* Кнопка «Пересчитать» (пересчитывает все значения на панели Итого для клиентов и на панели Доходы)

*Оплаты*

* Оплачено в рублях (вычисляемое поле, не редактируется)
Вычисляется так: суммируются с учетом валюты значения из поля «Сумма» на Платежах, Учитываются связанные с заказом платежи с типом «Приход» и статусом «Оплачен». Значение курса берется из модуля «Курсы валют» для указанной даты (Заказ: поле Курс) и валюты (поле Валюта на счете).
* Оплачено в USD (вычисляемое поле, не редактируется)
Вычисляется так: суммируются значения из поля «Сумма в долларах» на Платежах. Учитываются связанные с заказом платежи с типом «Приход» и статусом «Оплачен».
* Осталось оплатить в рублях (вычисляемое поле, не редактируется)
Вычисляется так: разница между значением поля «Полная цена» на заказе, переведенным в рубли в соответствии с курсом, и значением поля «Оплачено в рублях» на заказе. Значение курса берется из модуля «Курсы валют» для указанной даты (Заказ: поле Курс) и валюты (рубли)
* Осталось оплатить в USD (вычисляемое поле, не редактируется)
Вычисляется так: разница между значением поля «Полная цена» на заказе и значением поля «Оплачено в USD» на заказе.

h3. Колонки списка (ListView):

* Номер заказа
* Статус
* Код продукта
* Оператор
* Дата начала
* Дата окончания
* Агент
* Заказчик
* -Полная стоимость для клиента- Полная цена (сумма в USD)
* Ответственный

h3. Форма поиска (базовая):

* Статус (выпадающий список):
* Номер заказа
* Заказчик
* Агент
* Ответственный
* Код продукта

h3. Форма поиска (расширенная, pop-up):

* Статус (выпадающий список):
** Причина отказа
** Причина аннуляции
* Номер заказа
* Судно (поиск по судну продукта)
* Заказчик
* Агент
* Ответственный
* Код продукта
* Оператор
* Регион
* Название круиза
* Дата начала круиза (с/по)
* Дата окончания круиза (с/по)

h3. Связанные объекты:

* Участники круиза (один-ко-многим). Колонки:
** Порядковый номер
** Фамилия
** Телефон
** E-mail
** Категория каюты
** FOC
* Заказанные услуги (один-ко-многим). Колонки:
** Участник круиза
** Наименование услуги
** Полная стоимость для клиента (стоимость услуги)
** Комиссия
** Нетто
** Брутто
* Авиаперелет
* Заказанные гостиницы
* Экскурсии
* Трансфер
* Виза
* Страховка
* Счета
* Платежи
* Отзывы

h2. Агенты (модуль контрагенты)

h3. Поля модуля:

*Основные данные*

* Название (текстовое поле)
* Статус (выпадающий список: Потенциальный, Новый, Постоянный, Приоритетный)
* Файлы (файлы)
* Комментарий (многострочное текстовое поле)
* Группа агентов (выбор из групп агентов)
* Ответственный

*Контактные данные*

* Телефон 1 (телефон)
* Телефон 2 (телефон)
* Телефон 3 (телефон)
* Телефон 4 (телефон)
* Email (email)
* Сайт (ссылка)

*Данные для документов*

* Полное наименование компании (текстовое поле)
* В лице (текстовое поле)
* Фамилия И.О. (текстовое поле)
* Фамилия (текстовое поле)
* Имя (текстовое поле)

*Банковские реквизиты*

* Расчетный счет (текстовое поле)
* Банк (текстовое поле)
* ИНН (текстовое поле)
* БИК (текстовое поле)
* КПП (текстовое поле)
* Корсчет (текстовое поле)
* ОКАТО (текстовое поле)
* ОКПО (текстовое поле)
* ОГРН (текстовое поле)
* № в Федер реестре ТО (текстовое поле)

*Адреса*

* Фактический адрес (набор полей из:Улица, Город, Область, Индекс, Страна)
* Юридический адрес (набор полей из:Улица, Город, Область, Индекс, Страна)
* Почтовый адрес (набор полей из:Улица, Город, Область, Индекс, Страна)

h3. Колонки списка (ListView):

* Название
* Телефон 1
* Статус
* Ответственный

h3. Форма поиска (базовая):

* Название
* Ответственный

h3. Форма поиска (расширенная):

* Название
* Статус
* Комментарий

Форма поиска на Странице выборе контрагентов (на странице pop-up) соответствует расширенной форме поиска.

h3. Страница выбора Агента:

Вынести дополнительные поля на страницу выбора для создания нового контакта:

* Название
* Телефон
* Email

При нажатии на кнопку «Сохранить» создаваемый контакт выбирается, а страница выбора закрывается.

h3. Связанные объекты:

* Запланированные события
* Завершенные события
* Клиенты (многие-ко-многим)

h2. Поставщики

h3. Поля модуля:

*Основные данные*

* Название (текстовое поле)
* Тип (мультиселект: Услуги, Авиаперелеты, Гостиницы, Трансфер, Визы, Страховки)
* Файлы (файлы)
* Комментарий (многострочное текстовое поле)
* Ответственный

*Контактные данные*

* Телефон 1 (телефон)
* Телефон 2 (телефон)
* Телефон 3 (телефон)
* Телефон 4 (телефон)
* Email (email)
* Сайт (ссылка)

*Адреса*

* Фактический адрес (набор полей из:Улица, Город, Область, Индекс, Страна)
* Юридический адрес (набор полей из:Улица, Город, Область, Индекс, Страна)
* Почтовый адрес (набор полей из:Улица, Город, Область, Индекс, Страна)

h3. Колонки списка (ListView):

* Название
* Тип
* Телефон 1
* Email
* Ответсвенный

h3. Форма поиска (базовая и расширенная):

* Название
* Тип
* Ответственный

Форма поиска на Странице выборе Поставщиков (на странице pop-up) соответствует расширенной форме поиска.

h3. Страница выбора Поставщика:

Вынести дополнительные поля на страницу выбора для создания нового поставщика:

* Название
* Тип
* Телефон
* Email

При нажатии на кнопку «Сохранить» создаваемый поставщик выбирается, а страница выбора закрывается.

h3. Связанные объекты:

* Запланированные события
* Завершенные события

h2. Клиенты

h3. Поля модуля

* Фамилия (текстовое поле)
* Имя (текстовое поле)
* Отчество(текстовое поле)
* Тип (выпадающий список: клиент, сотрудник агента, участник круиза)
* Дата рождения (дата)
* Ответственный (пользователь)
* Команда (команда)
* Файлы (файлы)
* Описание (многострочное текстовое поле)

*Паспорт*

* Серия, номер (текстовые поля)
* Дата выдачи (дата)
* Кем выдано (многострочное текстовое поле)

*Загран. паспорт*

* Серия (текстовое)
* Номер (текстовое)
* Дата выдачи (Дата)
* Кем выдано (многострочное текстовое)
* Действителен до (дата)

*Контактные данные*

* Телефон 1 (телефон)
* Телефон 2 (телефон)
* Телефон 3 (телефон)
* Телефон 4 (телефон)
* E-mail (email)

*Адреса*

Адрес проживания

* Страна, 
* Область, 
* Город, 
* Улица, 
* Индекс


h3. Колонки списка

* Полное имя
* Телефон 1
* Телефон 2
* E-mail
* Ответственный

h3. Форма поиска (базовая):

* Фамилия
* Имя
* Отчество
* Телефон
* Email
* Ответственный

h3. Форма поиска (расширенная и страница выбора):

* Фамилия
* Имя
* Отчество
* Телефон
* Email
* Ответственный
* Команда

h3. Страница выбора Клиента:

Вынести дополнительные поля на страницу выбора для создания нового контакта:

* Фамилия
* Имя
* Телефон
* Email

При нажатии на кнопку Сохранить создаваемый контакт выбирается, а страница выбора закрывается.

h3. Связанные объекты:

* Запланированные и Завершенные события
* Участники круиза
* Заказы

h2. Участники круиза

h3. Поля модуля:

* Порядковый номер (автозаполнение; от 1 до Х – номер добавления участника круиза, нумерация своя для каждого заказа. например, заказ1: семья из трех человек, заказ2: молодежены. Списки участников будут такие: Заказ 1: Участник 1 – отец, Участник 2 – мать, Участник 3 – ребенок; Заказ 2: Участник 1 – жених, Участник 2 – невеста)
* Клиент (выбор из клиентов)
* Заказ (выбор из заказа)
* Файлы (файлы)
* Категория каюты (выпадающий список, формируется из списка кают продукта)
* FOC (галочка)
* Спец. предложения (вычисляемое поле, многострочное текстовое поле, заполняется в формате: «Название. Описание. Действует с/по»; данные берутся из модуля Спец. предложения).
* Номер каюты-места (выбор из каюта-местпродукта: ! открывается страница бронирования, отфильтрованная по выбранному продукту)
* Условия аннуляции
* Валюта
* Блок «Расчет стоимости»

Следующие поля из связанного клиента, должны отображаться на страницах Редактирования (без возможности редактировать), Просмотра, Списка, Выбора, на субпанелях:

* Фамилия
* Имя
* Телефон 1
* Телефон 2
* E-mail

h3. Колонки списка

* Полное имя
* Телефон 1
* Категория каюты
* Заказ
* FOC
* E-mail
* Полная стоимость для клиента
* Брутто
* Нетто
* Ответственный

h3. Форма поиска (базовая):

* Фамилия
* Имя
* Телефон
* Email
* Ответственный

h3. Форма поиска (расширенная и страница выбора):

* Фамилия
* Имя
* Телефон
* Email
* Ответственный
* Команда
* заказ
* агент
* статус заказа

Должна быть встроенная в субпанель форма быстрого редактирования

h2. Продукты

h3. Поля модуля:

* Код продукта (текстовое поле)
* Название круиза (текстовое поле)
* Дата начала круиза (дата)
* Дата окончания круиза (дата)
* Количество дней (вычисляемое поле, берется из Bitrix)
* Маршрут (выпадающий список: Массив всех маршрутов, который берется с Битрикс)
* Регион (выпадающий список: Массив всех регионов, который берется с Битрикс)
* Описание дней круиза (многострочное текстовое поле)
* Включено/не включено (многострочное текстовое поле)
* Специальные условия (многострочное текстовое поле)
* Тип (выпадающий список: наземный, для круиза, свой)
* Оператор (выбор из Операторов)
* Судно (выбор из судов)
* Примечание (многострочное текстовое поле)
* Ссылка на данный продукт на сайте (ссылка)

h3. Колонки списка (ListView):

* Код продукта
* Название
* Дата начала
* Дата окончания
* Оператор
* Судно

h3. Форма поиска (базовая, расширенная, pop-up):

* Название
* Дата начала
* Дата окончания
* Оператор
* Судно

h3. Связанные объекты:

* Заказы (один-ко-многим)
* Стоимости для кают (один-ко-многим)
* Каюта-место (один-ко-многим; панель на страницу просмотра не добавлять)
* Консульские представительства (многие-ко-многим)
* Специальные предложения

h2. Стоимости кают

h3. Поля модуля:

* Категория каюты (вычисляемое поле, будет выглядеть как выпадающий список, значения берутся из базы данных?)
* Продукт (выбор из Продуктов)
* Стоимость (текстовое поле, нужна проверка ввода либо маска)
* Примечание (многострочное текстовое поле)

h3. Колонки списка (ListView):

* Категория каюты
* Судно
* Продукт
* Стоимость
* Примечание

h3. Форма поиска (базовая, расширенная, pop-up):

* Категория каюты
* Судно
* Продукт
* Стоимость от/до
* Примечание

h2. Суда

h3. Поля модуля:

* Название (текстовое поле)
* Оператор (выбор из операторов)
* Класс судна (текстовое поле)
* Технические характеристики судна (многострочное текстовое поле)

h3. Колонки списка (ListView):

* Название
* Оператор

h3. Форма поиска (базовая, расширенная, pop-up):

* Название
* Оператор

h3. Связанные объекты:

* Продукт (один-ко-многим)
* Услуги (один-ко-многим)
* Сетка комиссий(один-ко-многим)
* Каюта-место (один-ко-многим)

h2. Каюты-места

h3. Поля модуля:

* Участник круиза (выбор из участников круиза: связь один-к-многим: один участник, много каюта-мест)
* Продукт (выбор из продуктов)
* Номер каюты (текстовое поле)
* Категория каюты (выбор из списка)
* Номер места (текстовое поле)
* Палуба (текстовое поле)
* Судно (выбор судов) *[судно есть на связанном продукте, зачем тут еще раз судно?]*
* Примечание (многострочное текстовое поле)

h3. Колонки списка (ListView): 

* Номер каюты-места (выводится склеенный номер «каюта-место», например «57-1»)
* Категория каюты (выбор из списка)
* Судно

h3. Форма поиска (базовая, расширенная, pop-up): 

* Номер каюты (текстовое поле)
* Номер места (текстовое поле)
* Категория каюты (мультиселект)
* Судно (выбор)
* Продукт (выбор)

h2. Операторы

h3. Поля модуля: 

* Название (текстовое поле)
* Комиссия (текстовое поле)
* Выставлять счет нам до начала круиза за (дней) (число)

h3. Колонки списка (ListView): 

* Название

h3. Форма поиска (базовая, расширенная, pop-up): 

* Название

h2. Сетка комиссий

Страниц редактирования, просмотра и списка не будет. Все записи «Сетки комиссий» создаются только на специальной странице для заведения комиссий.

h3. Поля модуля: 

* Судно (выбор из Судов)
* Тип комиссии (выпадающий список: нам, агенту)
* Группа агентов (выбор из группы агентов)
* Регионы (выпадающий список, данные из таблицы регионов, которая заполняется из Битрикс)
* Количество, от (текстовое поле)
* Количество, до (текстовое поле)
* Процент (текстовое поле)

h2. Наценки/Скидки

h3. Поля модуля: 

* Название (текстовое поле)
* Кому (выпадающий для нас/для клиента)
* Учитывать в счете (галочка)
* Скидки/Наценки (выпадающий список: наценка, скидка)
* Тип (список: процент, сумма)
* Величина (число)
* Связано с (parent по модулям:Участники круиза, Заказанные услуги, Авиаперелет, Заказанные гостиницы,Участие в экскурсии, Трансфер, Виза, Страховка)

h3. Колонки списка (ListView): 

* Название
* Скидки/Наценки
* Тип
* Величина
* Связано с

h3. Форма поиска (базовая, расширенная, pop-up): 

* Название
* Скидки/Наценки
* Связано с

h2. Услуги (на базе модуля Прайс-лист)

h3. Поля модуля: 

* Наименование услуги (текстовое поле)
* Судно (выбор из Судов)
* Поставщики (выбор из Поставщиков, на popup фильтрация по типу, Тип=Услуги)
* Стоимость услуги (текстовое поле)
* Дата (дата)
* Условия аннуляции (многострочное текстовое поле)
* Примечание (многострочное текстовое поле)

h3. Колонки списка (ListView): 

* Наименование услуги
* Судно
* Поставщик
* Стоимость услуги
* Дата

h3. Форма поиска (базовая, расширенная, pop-up):

* Название (текстовое)
* Судно (выбор)

h3. Связанные объекты: 

* Заказанные услуги

h2. Заказанные услуги

h3. Поля модуля: 

* Услуга (выбор из услуг)
* Количество (текстовое поле)
* Заказ (выбор из заказов)
* Участник круиза (выбор из Участников круиза выбранного Заказа)
* Комиссия (текстовое поле)
* Валюта
* Условия аннуляции (многострочное текстовое поле)
* -Полная стоимость (текстовое поле, переносится из корзины)- будет на блоке Стоимость услуги
* Блок «Стоимость услуги» (поля блока расписаны ниже, этот блок присутствует на нескольких модулях)

На всех страницах (на странице редактирования, просмотра, списка) могут отображаться данные из связанной услуги:

* Судно
* Поставщик
* Стоимость услуги
* Дата

h3. Колонки списка (ListView): 

* Наименование услуги
* Судно
* Заказ
* Количество
* -Комиссия- [правка по комментариям клиента]
* Полная стоимость для клиента
* Нетто
* Брутто

h3. Форма поиска (базовая, расширенная, pop-up): 

* Наименование услуги
* Судно
* Заказ
* Количество

h2. Авиаперелеты

h3. Поля модуля: 

* Город отправления (справочник городов мира; заполняется автоматически при заполнении аэропорта отправления; есть автофил)
* Аэропорт отправления (справочник аэропортов, отфильтрованных по выбранному городу; можно выбрать, введя код аэропорта; есть автофил)
* Город прибытия (аналогично отправлению)
* Аэропорт прибытия (аналогично отправлению)
* Заказ (выбор из заказов)
* Участник круиза (выбор из Участников круиза выбранного Заказа)
* Дата-время вылета (дата-время)
* Дата-время прилета (дата-время)
* № Рейса (текстовое поле)
* Авиакомпания (выбор из авиакомпаний) *[это не одно и то же, что поставщик? если нет, то откуда выбор?? модуля авиакомпании нет]*
* Класс (выпадающий список: Первый класс, Бизнес-класс, Эконом-класс)
* Поставщик (выбор из поставщиков, на popup фильтрация по типу, Тип=Авиаперелеты)
* Условия аннуляции (многострочное текстовое поле)
* Примечание (многострочное текстовое поле)
* Валюта
* Блок «Стоимость услуги»

h3. Колонки списка (ListView): 

* Участник круиза (участник круиза)
* Дата-время вылета (дата-время)
* Дата-время прилета (дата-время)
* Аэропорт отправления
* Аэропорт прибытия
* № Рейса
* Авиакомпания
* Полная стоимость для клиента
* Нетто
* Брутто

h3. Форма поиска (базовая): 

* Участник круиза
* Дата отправления
* Город отправления
* Аэропорт отправления
* Город прибытия
* Аэропорт прибытия
* № Рейса
* Авиакомпания
* Класс
* Поставщик

h3. Форма поиска (расширенная, pop-up): 

* Участник круиза
* Дата отправления с/по
* Город отправления
* Аэропорт отправления
* Город прибытия
* Аэропорт прибытия
* Рейс
* Авиакомпания
* Класс
* Поставщик

h2. Гостиницы

h3. Поля модуля: 

* Название отеля (текстовое поле)
* Страна (выбор из стран)
* Город (выбор из городов, отфильтрованных по стране)
* Категория (текстовое поле)
* Расчетный час (текстовое поле)
* Условия аннуляции (многострочное текстовое поле)

h3. Колонки списка (ListView): 

* Название отеля
* Страна 
* Город 
* Категория

h3. Форма поиска (базовая, расширенная, pop-up): 

* Страна
* Город
* Категория
* Название

h2. Заказанные гостиницы

h3. Поля модуля: 

* Отель (выбор из отелей)
* Заказ (выбор из заказов)
* Участник круиза (выбор из участников выбранного заказа! по кнопке Выбрать открывать список, отфильтрованный по выбранному заказу)
* Дата С (дата)
* Дата По (дата)
* Ночей (вычисляемое поле: количество ночей с «дата с» по «дата по»)
* Питание (выпадающий список: Завтрак, Полупансион, Полный пансион)
* Категория номера (текстовое поле)
* Примечание (многострочное текстовое поле)
* Условия аннуляции (многострочное текстовое поле)
* -Полная стоимость (текстовое поле)- будет на блоке Стоимость услуги
* Валюта
* Блок «Стоимость услуги»

На всех страница (на странице редактирования, просмотра, списка) могут отображаться данные из связанной гостиницы:

* Название отеля
* Страна
* Город
* Класс отеля
* Поставщик

h3. Колонки списка (ListView): 

* Название отеля
* Город
* Заказ
* Участник круиза
* Категория номера
* Ночей
* Полная стоимость для клиента
* Нетто
* Брутто

h3. Форма поиска (базовая): 

* Название отеля
* Город
* Заказ
* Участник круиза

h3. Форма поиска (расширенная, pop-up): 

* Название отеля
* Город
* Заказ
* Участник круиза
* Категория номера
* Ночей
* Дата С (дата)
* ДатаПо (дата)
* Поставщик

h2. Экскурсии 

h3. Поля модуля: 

* Название (текстовое поле)
* Дата время начала (дата+время)
* Дата время окончания (дата+время)
* Количество дней (вычисляемое поле: Дата окончания - Дата начала + 1)
* Поставщик (выбор из поставщиков, на popup фильтрация по типу, Тип=Экскурсии)
* Условия аннуляции (многострочное текстовое поле)
* Примечание (многострочное текстовое поле)

h3. Колонки списка (ListView): 

* Название
* Дата время начала
* Дата время окончания
* Количество дней

h3. Форма поиска (базовая, расширенная, pop-up): 

* Название
* Дата начала с/по (дата)
* Дата окончания с/по (дата)
* Поставщик

h2. Участия в экскурсиях

h3. Поля модуля:

* Название (выбор из экскурсий)
* Заказ (выбор из заказов)
* Участник круиза (выбор из Участников круиза выбранного заказа)
* Дата время начала (дата+время, вычисляемое: копируется из связанной экскурсии; редактируемое)
* Дата время окончания (дата+время, вычисляемое: копируется из связанной экскурсии; редактируемое)
* Количество дней (вычисляемое поле: Дата окончания - Дата начала + 1)
* Поставщик (текстовое, не редактируемое поле, подтягиваем из экскурсии)
* Условия аннуляции (многострочное текстовое поле, не редактируемое поле, подтягиваем из экскурсии)
* Примечание (многострочное текстовое поле, не редактируемое поле, подтягиваем из экскурсии)
* Валюта
* Блок «Стоимость услуги»

h3. Колонки списка (ListView):

* Название
* Заказ 
* Участник круиза 
* Дата время начала 
* Дата время окончания 
* Количество дней 
* Полная стоимость для клиента
* Нетто 
* Брутто

h3. Форма поиска (базовая, расширенная, pop-up):

* Название
* Заказ 
* Участник круиза 

h2. Трансферы

h3. Поля модуля: 

* Заказ (выбор из заказов)
* Участник круиза (выбор из Участников круиза выбранного Заказа)
* Страна (список стран)
* Город (список городов)
* Дата время (дата)
* № Рейса (текстовое поле)
* Категория транспортного средства (выпадающий список: Групповой, Индивидуальный)
* Язык гида: (выпадающий список: Не указано, Местный, Русский, Английский)
* Поставщик (выбор из Поставщиков, на popup фильтрация по типу, Тип=Трансфер)
* Условия аннуляции (многострочное текстовое поле)
* Примечание (многострочное текстовое поле)
* Маршрут (многострочное текстовое)
* Валюта
* Блок «Стоимость услуги»

h3. Колонки списка (ListView): 

* Название
* Заказ
* Участник круиза
* Страна
* Город
* Дата время
* № Рейса
* Полная стоимость для клиента
* Нетто
* Брутто

h3. Форма поиска (базовая, расширенная, pop-up): 

* Название
* Заказ
* Участник круиза
* Страна
* Город
* Дата время
* № Рейса

h2. Визы

h3. Поля модуля: 

* Название (вычисляемое поле, на странице редактирования нет, состоит из «Страна+Участник круиза»)
* Страна (выбор из стран)
* Срок подачи (дата)
* Напомнить (дата)
* Заказ (выбор из заказа)
* Участник круиза (выбор из Участников круиза выбранного Заказа)
* Примечание (многострочное текстовое поле)
* Поставщик (выбор из поставщиков, на popup фильтрация по типу, Тип=Визы)
* Условия аннуляции (многострочное текстовое поле)
* Валюта
* Блок «Стоимость услуги»

h3. Колонки списка (ListView): 

* Страна
* Срок подачи
* Напомнить
* Заказ
* Участник круиза
* Полная стоимость для клиента
* Нетто
* Брутто

h3. Форма поиска (базовая, расширенная, pop-up): 

* Название
* Страна *[если название состоит из «Страна+Участник круиза», то зачем нам поиск по стране отдельный?]*

*Раздел главной страницы* должен содержать фильтрацию по следующим полям:
* Страна (выбор из стран) (пока что сделан как поиск просто по текстовому полю, по вхождению)
* Срок подачи (дата)
* Напомнить (дата)

h2. Страховки

h3. Поля модуля: 

* Заказ (выбор из заказов)
* Участник круиза (выбор из Участников круиза Заказа)
* Тип (выпадающий список:Общая, Включающая эвакуацию и репатриацию)
* Территория (многострочное текстовое поле)
* Франшиза (выпадающий список: да, нет)
* Список застрахованных рисков и покрытий (многострочное текстовое поле)
* Примечание (многострочное текстовое поле)
* Поставщик (выбор из поставщиков, на popup фильтрация по типу, Тип=Страховки)
* Условия аннуляции (многострочное текстовое поле)
* Валюта
* Блок «Стоимость услуги»

h3. Колонки списка (ListView): 

* Тип
* Заказ
* Участник круиза
* Территория
* Франшиза
* Полная стоимость для клиента
* Нетто
* Брутто

h3. Форма поиска (базовая, расширенная, pop-up): 

* Тип
* Территория
* Франшиза
* Заказ
* Участник круиза

h2. Платежи

h3. Поля модуля: 

* Тип (выпадающий список:Приход, Расход; вычисляемое)
* Планируемая дата оплаты (дата)
* Фактическая дата оплаты (дата)
* Статус оплаты (выпадающий список: планируется, оплачен, отмена)
* Счет (выбор из счетов Заказа)
* Заказ (выбор из Заказов, заполняется автоматически при выборе Счета)
* Валюта (вычисляемое, не редактируемое, берется из валюты связанного Счета)
* Сумма (текстовое поле)
* Сумма в долларах (пересчет суммы по курсу на день поступления)
* Курс (вычисляемое редактируемое текстовое поле, выставляется значение курса на день платежа)
* Форма оплаты (выпадающий список: наличные, безналичный)
* Примечание (многострочное текстовое поле)
* Файлы (файл)

h3. Колонки списка (ListView): 

* Тип
* Статус
* Заказ
* Контрагент (подтягивается из связанного счета)
* Сумма
* Валюта
* Планируемая дата оплаты
* Фактическая дата оплаты

h3. Форма поиска (базовая, расширенная, pop-up): 

* Тип
* Планируемая дата оплаты
* Фактическая дата оплаты
* Статус оплаты
* Контрагент (подтягивается из связанного счета)
* Заказ
* Форма оплаты

h3. Вычисляемые поля

Допустимые значения поля Тип зависят от родительского Счёта. 

Так, для счёта с типом «Заказчик» или «Агент» можно создавать платежи с типом «Приход». Для счёта с типом «Оператор» или «Поставщик» — с типом «Расход».

h3. Дополнительные настройки

Платёж можно создать только с субанели на Счёте.

h2. Счета

h3. Поля модуля: 

* Тип (список: клиенту, агенту, от поставщика, от оператора)
* Оплатить до (дата)
* Дата оплаты (дата)
* Статус (список: не оплачен, частично оплачен, оплачен, отменен)
* Заказ (выбор из Заказов, нередактируемое)
* Контрагент(выбор из Участников круиза, Агентов, Поставщиков, Операторов)
* Сумма (вычисляемое, нередактируемое)
* Валюта (выбор из Валют, список)
* Дата курса (дата)
* Форма оплаты (список: Наличные, Безналичный)
* Примечание (многострочное)
* Оплачено (вычисляемое, нередактируемое, отображается на форме редактирования)
* Файлы (файл)
* "Курс USD (ЦБРФ + 2%)" (вычисляемое)
* "Курс EUR (ЦБРФ + 2%)" (вычисляемое)

Вычисляемые поля описаны здесь: [[ТЗ-Работа_со_счетами#Вычисляемые-поля]]

h3. Колонки списка (ListView): 

* Статус
* Заказ
* Контрагент
* Сумма (с валютой)
* Оплатить до
* Дата оплаты

h3. Форма поиска (базовая, расширенная, pop-up): 

* Оплатить до
* Дата оплаты
* Статус
* Контрагент
* Заказ

h3. Связи 

* Платежи (многие к одному)

h2. Отзывы туристов

h3. Поля модуля: 

* Отзыв (многострочное текстовое поле)
* Заказ (выбор из Заказов)
* Дата отзыва (дата)
* Участник круиза (выбор из Участников круиза заказа)

h3. Колонки списка (ListView): 

* Отзыв
* Заказ
* Участник круиза
* Дата отзыва

h3. Форма поиска (базовая, расширенная, pop-up): 

* Участник круиза
* Заказ
* Отзыв (поиск по вхождению)

h2. События

h3. Поля модуля: 

* Название (текстовое поле)
* Тип (выпадающий список: задача, звонок, встреча)
* Комментарий (многострочное текстовое поле)
* Статус (запланировано, в процессе, завершено, отмена)
* Дата выполнения (дата-время)
* Относится к (родитель)
* Информация о связанном объекте (на странице просмотра)
* Напомнить за (выпадающий список)
* Дата создания (на странице просмотра)
* Кем создано (на странице просмотра)
* Ответственный

h3. Колонки списка (ListView): 

* Закрыть
* Тип
* Название
* Дата выполнения
* Статус
* Относится к
* Ответственный

h3. Форма поиска (базовая): 

* Название
* Дата выполнения (с/по)
* Относится к
* Ответственный

h3. Форма поиска (расширенная, pop-up): 

* Название
* Дата выполнения (с/по)
* Относится к
* Комментарий
* Ответственный
* Дата создания
* Кем создано (выбор из пользователей)

h2. Cпец. предложения

h3. Поля модуля: 

* Название (текстовое поле)
* Опубликовано на сайте (галочка, не редактируется, приходит из Bitrix)
* Описание (многострочное текстовое поле)
* Дата действия, с (дата)
* Дата действия, по (дата)
* Продукт (выбор из продуктов)

h3. Колонки списка (ListView): 

* Название
* Описание
* Дата действия, с
* Дата действия, по
* Продукт

h3. Форма поиска (базовая, расширенная, pop-up): 

* Название
* Описание
* Дата действия, с
* Дата действия, по
* Продукт

h2. Группы агентов

h3. Поля модуля: 

* Название (текстовое поле)

h3. Колонки списка (ListView): 

* Название

h3. Форма поиска (базовая, расширенная, pop-up): 

* Название

h3. Связи: 

* Агенты (один-ко-многим)

h2. Консульские представительства

h3. Поля модуля:

* Наименование представительства (текстовое поле)
* Страна (текстовое поле, автофил)
* Город (текстовое поле, автофил)
* Адрес (текстовое поле)
* Телефон (текстовое поле)
* Факс (текстовое поле)
* Культурная информацию по стране (многострочное текстовое поле с форматирование высотой в два экрана)

h3. Колонки списка (ListView): 

* Наименование представительства
* Страна
* Город
* Адрес
* Телефон
* Факс

h3. Форма поиска (базовая, расширенная, pop-up): 

* Страна
* Город
* Наименование представительства
* Телефон

h3. Связи: 

* Продукт (многие-ко-многим)

h2. Документы 

не отдельный модуль, только страница со списком всех документов в системе)

Необходимо добавить страницу со списком всех загруженных в систему документов (в поле Файл). Сюда должны попасть как загруженные вручную документы, так и документы сгенерированные по шаблону.

h3. Колонки списка (ListView): 

* Название
* Связан с
* Дата создания
* Файл (ссылка для скачивания документа)

h3. Форма поиска (базовая, расширенная, pop-up): 

* Название
* Связан с